<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W3LFMLDQ');</script>
<!-- End Google Tag Manager -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Verify - sami.is-a.dev</title>
<style>
  html,body{height:100%;margin:0;font-family:'Space Grotesk',system-ui,Arial,sans-serif}
  body{display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#f8f9fa,#e3f2fd);cursor:auto}
  .box{background:rgba(255,255,255,0.98);padding:24px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.12);text-align:center;max-width:540px}
  h1{margin:0 0 8px;font-size:20px}
  p{margin:0 0 14px;color:#444}
  #recaptcha-placeholder{min-height:78px}
</style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W3LFMLDQ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <div class="box">
    <h1>Verify you're human</h1>
    <p>Please complete the CAPTCHA below to continue.</p>
    <div id="recaptcha-placeholder"></div>
  </div>

<script>
const SITE = location.origin.replace(/\/$/,''); // e.g. https://sami.is-a.dev
const MAIN = SITE + '/?verified=1';
const COOKIE_NAME = 'sami_verified';
const COOKIE_DAYS = 7;

function setCookie(name,value,days){
  const d=new Date(); d.setTime(d.getTime() + (days*24*60*60*1000));
  document.cookie = `${name}=${value};expires=${d.toUTCString()};path=/;SameSite=Lax`;
}
function getCookie(name){
  const pairs=document.cookie.split(';').map(s=>s.trim());
  for(const p of pairs) if(p.startsWith(name+'=')) return p.split('=')[1];
  return null;
}

if(getCookie(COOKIE_NAME) === 'true'){
  window.location.replace(MAIN + '&ts=' + Date.now());
} else {
  const s=document.createElement('script');
  s.src='https://www.google.com/recaptcha/api.js?onload=__onRecaptchaLoad&render=explicit';
  s.async=true; s.defer=true;
  document.head.appendChild(s);

  window.__onRecaptchaLoad = function(){
    const holder = document.getElementById('recaptcha-placeholder');
    holder.innerHTML = '';
    const wrapper = document.createElement('div'); wrapper.id = 'gwidget';
    holder.appendChild(wrapper);

    window.grecaptcha.render('gwidget', {
      sitekey: '6LcRBhAsAAAAACatryubAg_7jPQPb5i_tcAIoCa-',
      callback: onRecaptchaSuccess,
      theme: 'light'
    });
  };

  function onRecaptchaSuccess(token){
    setCookie(COOKIE_NAME,'true', COOKIE_DAYS);
    localStorage.setItem(COOKIE_NAME, 'true');
    window.location.replace(MAIN + '&ts=' + Date.now());
  }
  window.onRecaptchaSuccess = onRecaptchaSuccess;
}
</script>
</body>
</html>
